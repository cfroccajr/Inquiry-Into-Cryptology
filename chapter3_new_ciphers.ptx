<?xml version="1.0" encoding="UTF-8" ?>

<!--********************************************************************
Copyright 2017 Charles F. Rocca Jr

This file is part of a MathBook XML project.

This project is focused on creating a brief inquiry based text for 
use in a introductory course in cryptology for non-technical students.  
The material is presented, whenever possible, in a historically honest 
manner.

Copyright 2015 Robert A. Beezer

This file is part of MathBook XML.

MathBook XML is free software: you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation, either version 2 or version 3 of the
License (at your option).

MathBook XML is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with MathBook XML.  If not, see <http://www.gnu.org/licenses/>.
*********************************************************************-->

<chapter xml:id="New_Ciphers" xmlns:xi="http://www.w3.org/2001/XInclude">
    <title> Mixing Things Up </title>
    <introduction>
        <p>
            In this chapter look at real improvements to cryptology:
            <ul>
                <li> Polyalphabetics (Alberti)</li>
                <li> Autokey Cipher (Vigen&#x00E8;re)</li>
                <li> Keyed Columnar Ciphers and Codes (Falconer)</li>
                <li> Thomas Jefferson's contributions???</li>
            </ul>
        </p>
    </introduction>





    <!--%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
    
        Alberti and Polyalphabetics 

    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%-->
    <section xml:id="section_alberti">
        <title> Alberti's Great Idea </title>
        <objectives>
            <ul>
                <li>
                    Alberti's Biography
                </li>
                <li>
                    Alberti's Polyalphabetic
                </li>
                <li>
                    Modern/Vigen&#x00E8;re's Polyalphabetic
                </li>
            </ul>
        </objectives>

        <subsection>
            <title> Alberti's Biography </title>
            <p>
                For now see his biography on the MacTutor History of Mathematics Site: 
                <url href="http://www-groups.dcs.st-and.ac.uk/history/Biographies/Alberti.html">
                Leon Battista Alberti</url><idx>Alberti, Leon Battista</idx>
            </p>
        </subsection>

        <subsection>
            <title>Alberti's Polyalphabetic Cipher</title>
            <definition>
                <title>Polyalphabetic Substitution Cipher</title>
                <statement>
                    <p>
                        A <term>polyalphabetic substitution cipher</term><idx>polyalphabetic substitution cipher</idx> is a cipher in which a single plaintext letter maybe replaced by several different ciphertext letters, groups of letters, or symbols and every letter, group of letters, or symbol in the ciphertext may represent more than one plain text letter.
                    </p>
                </statement>
            </definition>
            <p>
                One of Leon Battista Alberti's greatest contributions to cryptology was not his cryptanalysis skills but an entirely new kind of cipher.  Many efforts had been and would be made to shore up monoalphabetic substitution ciphers.  Some of these efforts worked well enough but they were never sufficiently different to make them immune to the sorts of attacks we have studied before.   Alberti made something truly different
                he invented a <term>polyalphabetic substitution cipher</term>.  This was a cipher that did not just replace the plain text alphabet with a single separate alphabet but instead used multiple enciphering alphabets to create greater confusion and security.
            </p>
            <sidebyside widths="40% 40%" margins="0%">
                <p>
                    The key to Alberti's new system was a device he called a <term><q>formula</q></term>
                    <idx>formula (Alberti)</idx>.  This was a cipher disk consisting of a fixed outer disk and a mobile inner disk.  In his basic description of his new cipher he would use the outer ring of upper case letters for his plain text and the inner mobile ring of lower case letters for his cipher text.
                </p>
                <figure xml:id="figure_alberti_disk">
                    <caption>Alberti's Cipher Disk or <term><q>Formula</q></term></caption>
                    <image width="100%" source="images/Alberti_cipher_disk.png" archive="svg png pdf">
                        <description> This is an image of Leon Battista Alberti's Cipher Disk as he described it. </description>
                    </image>
                </figure>
            </sidebyside>
            <xi:include href="quote_code/alberti_polyalpha.ptx" />
            <p>
                <alert>Comprehension Check:</alert>
                <ul>
                    <li>
                        If you compare the inner and outer rings of the formula (cipher disk) what difference do you notice?  Why do you think Alberti might have made these choices?  (For reference I made an updated version in the appendix where I made similar choices, <xref ref="appendix_figure_modern" />.)
                    </li>
                    <li>
                        What step in the process above stops this from simply being a shift cipher?
                    </li>
                    <li>
                        How does the recipient of a message using Alberti's method know how to set their disk and when they should change it?
                    </li>
                    <li>
                        Is there an obvious weakness in the way that Alberti suggests using his system?
                    </li>
                </ul>
            </p>
            <exercise>
                <statement>
                    <p>
                        If you have not done so already make a copy of Alberti's formula [<xref ref="figure_alberti_disk" />] so that you can use it for enciphering and deciphering.  Now encipher <q>See my first message</q> using an index of <em>c</em> initially underneath the <em>G</em>, but shift it underneath <em>V</em> after the first two words.
                    </p>
                </statement>
                <hint>
                    <p>
                        <ul>
                            <li>Remember to line up the index <em>c</em> with the capital letters used of the key, here <em>G</em> and <em>V</em>.</li>
                            <li>For Alberti, uppercase letters (the outer ring) are the plaintext and lowercase letters are the ciphertext.</li>
                            <li>Because of what was and was not included on the disk you will need to make some choices.</li>
                        </ul>
                    </p>
                </hint>
                <answer>
                    <p>
                        <c>G vbb ke V xsdba m&amp;bbry&amp;</c>
                    </p>
                </answer>
            </exercise>
            <exercise>
                <statement>
                    <p>
                        Suppose that <c>B lgiq R yam V ydme</c> was enciphered using an index of <em>k</em> as directed by Alberti, what does it say? <!--cats and dogs-->
                    </p>
                </statement>
                <hint>
                    <p>
                        <ul>
                            <li>First identify the three key letters used in this cipher.</li>
                            <li>Remember to line up the index <em>k</em> with the capital letters used of the key, and to move the index when the key letter changes.</li>
                            <li>For Alberti, uppercase letters (the outer ring) are the plaintext and lowercase letters are the ciphertext.</li>
                        </ul>
                    </p>
                </hint>
                <answer>
                    <p>
                        cats and dogs
                    </p>
                </answer>
            </exercise>
            <exercise>
                <statement>
                    <p>
                        Team up with a partner and agree on a lower case index.  Now each of you should try enciphering a short message, only five or six words, be sure to adjust your formula after every couple of words.  Then exchange messages with your partner and decipher each others messages.
                    </p>
                </statement>
            </exercise>
            <figure>
            <caption>Alberti's Formula</caption>
                <interactive xml:id="alberti_disc" platform="sage" width="100%" aspect="1:1">
                    <slate surface="sage">
                        <xi:include href="sage_code/alberti_disc.sage" parse="text"/>
                    </slate>
                </interactive>
            </figure>
        </subsection>

        <subsection xml:id="vigenere_cipher">
            <title>Vigen&#x00E8;re's Cipher</title>
            <p>
                In spite of the fact that Alberti invented the polyalphabetic cipher his is not the name associated with it, instead that honor goes to the Frenchmen <em><alert>Blaise de Vigen&#x00E8;re</alert></em><idx>Vigen&#x00E8;re, Blaise de</idx>.  Vigen&#x00E8;re made a careful study of the cryptographers who had come before him and in 1586 he published the culmination of his work in his <em>Traict&#x00E9; des chiffress, ou secr&#x00E8;tes mani&#x00E8;res d'escrire</em><xref ref="cr_crypt_vigenere" />.  In the Traict&#x00E9; he described a wide variety of older ciphers and his improvements to them.  Among these was his take on Alberti's polyalphabetic cipher.
            </p>
            <p>
                One of the key advances that Vigen&#x00E8;re made was to replace the disk with a table [<xref ref="figure_vigenere_table" text="type-global"/>, <xref ref="cr_crypt_vigenere" detail="p. 50b (102)"/><fn>In the page designation <q>p. 50b (102)</q> the 102 is the page in the pdf document while the 50b is the page in the manuscript.</fn>].  This made it easier to vary between alphabets without having to move inner and outer disks to different positions.
            </p>
            <xi:include href="quote_code/vigenere_cipher.ptx" />
            <figure xml:id="figure_vigenere_table">
                <caption>
                    Vigen&#x00E8;re's Tableau
                </caption>
                <image width="100%" source="images/vigenere_table.png">
                    <description> This is Vigen&#x00E8;re's tableau as he actually used it in his text.  </description>
                </image>
            </figure>
            <p>
                <alert>Comprehension Check:</alert>
                <ul>
                    <li>
                        How did the <em>a</em> in the saying <em><q>au nom de l'eternel</q></em> get replaced with a <em>b</em> in the ciphertext <em>bqnsamiconcoal</em>?
                    </li>
                    <li>
                        How did the <em>u</em> in the saying <em><q>au nom de l'eternel</q></em> get replaced with a <em>q</em> in the ciphertext <em>bqnsamiconcoal</em>?
                    </li>
                    <li>
                        How did the first <em>e</em> in the saying <em><q>au nom de l'eternel</q></em> get replaced with a <em>i</em> in the ciphertext <em>bqnsamiconcoal</em>?
                    </li>
                    <li>
                        How did the second <em>e</em> in the saying <em><q>au nom de l'eternel</q></em> get replaced with a <em>o</em> in the ciphertext <em>bqnsamiconcoal</em>?
                    </li>
                    <li>
                        All four <em>e</em>'s in the plaintext were replaced different ciphertexts, why and how did this happen?
                    </li>
                </ul>
            </p>
            <exercise>
                <statement>
                    <p>
                        To further check your understanding try enciphering the message <em><q>vive la france</q></em> using the key <em>aider</em> and the black (outer) rows in <xref ref="figure_vigenere_table"/>, since there are more letters in the message than the key you will need to restart at the beginning of the key when you get to the end.
                    </p>
                </statement>
                <hint>
                    <p>Try writing the key above the message so that you can keep track of how they correspond, like this:</p>
                    <pre>
                        Key:        a i d e r a i d e r a i
                        Plaintext:  v i v e l a f r a n c e
                        Ciphertext: Q O
                    </pre>
                    <p>
                        Also, recall that you look up the letters in the message along the top and the key along the side.
                    </p>
                </hint>
                <answer>
                    <p>
                        Ciphertext: <c>QOTEASLQACVI</c>
                    </p>
                </answer>
            </exercise>
            <exercise>
                <statement>
                    <p>
                        To further check your understanding try enciphering the message <em><q>escargot</q></em> using the key <em>ail</em>; in <xref ref="figure_vigenere_table"/> use the red (inner) labels for the message and the black (outer) column for the key, since there are more letters in the message than the key you will need to restart at the beginning of the key when you get to the end.
                    </p>
                </statement>
                <hint>
                    <p>Try writing the key above the message so that you can keep track of how they correspond, like this:</p>
                    <pre>
                        Key:        a i l a i l a i
                        Plaintext:  e s c a r g o t
                        Ciphertext:
                    </pre>
                    <p>
                        Also, recall that you look up the letters in the message along the top and the key along the side.
                    </p>
                    <p>
                        Finally, enciphering (and deciphering) goes faster if you do all the characters enciphered with a particular key letter at one time; so first do everything enciphered with <em>a</em>, then <em>i</em>, and then <em>l</em>.
                    </p>
                </hint>
                <answer>
                    <p>
                        Ciphertext: <c>IIREHXSL</c>
                    </p>
                </answer>
            </exercise>
            <exercise>
                <statement>
                    <p>
                        Try deciphering the message <c>NODDTEMDQNHO</c> using the key <em>vilo</em> and the black (outer) labels.
                    </p>
                </statement>
                <hint>
                    <p>
                        <ul>
                            <li>Recall that the plaintext letters run along the top and the key letters are along the left side.</li>
                            <li>You need to look up the ciphertext letters in the interior of the table.</li>
                            <li>Line up the ciphertext and the key in the same way you lined up the plaintext and key previously.</li>
                        </ul>
                    </p>
                    <pre>
                        Key:        v i l o v i l o v i l o
                        Ciphertext: N O D D T E M D Q N H O
                        Plaintext:  t o u
                    </pre>
                </hint>
                <answer>
                    <p>
                        Plaintext:  <em>tour de france</em>
                    </p>
                </answer>
            </exercise>

            <exercise>
                <statement>
                    <p>
                        Try deciphering the message <c>DOLSASXS</c> using the key <em>manger</em> and the red (inner) labels.
                    </p>
                </statement>
                <hint>
                    <p>
                        <ul>
                            <li>Recall that the plaintext letters run along the top and the key letters are along the left side.</li>
                            <li>You need to look up the ciphertext letters in the interior of the table.</li>
                            <li>Line up the ciphertext and the key in the same way you lined up the plaintext and key previously.</li>
                        </ul>
                    </p>
                </hint>
                <answer>
                    <p>
                        Plaintext: <em>baguette</em>
                    </p>
                </answer>
            </exercise>
            <p>
                Today when we use the Vigen&#x00E8;re Cipher we use a table <xref ref="appendix_figure_vigenere_new" text="type-global" /> which is simpler, and makes the resulting cipher a little easier to crack.  The video below explains using the more modern table and you will play with the modern version in the exercises.
            </p>
            <figure xml:id="suzuki_vigenere_video">
                <caption>Modern look at the Vigenere Cipher</caption>
                <video youtube="5ISnCm4_V-Y" width="80%"/>
            </figure>
        </subsection>


    </section>


    <!--%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

        Agripa and the Pigpen Cipher 

    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%-->
    <section xml:id="section_agripa">
        <title> Variation on a Theme </title>
        <objectives>
            <ul>
                <li>
                    Agripa's Biography
                </li>
                <li>
                    Agripa/Vigeners's Pigpen Cipher
                </li>
                <li>
                    Modern Pigpen Cipher
                </li>
            </ul>
        </objectives>
        <subsection xml:id="agripa_bio">
            <title> Biography of Heinrich Cornelius Agripa</title>
            <p>
                Insert Bio Here When Available ... <idx>Agripa, Heinrich Cornelius</idx>
            </p>
        </subsection>
        <subsection xml:id="pigpen_cipher">
            <title> Pigpen Cipher </title>
            <p>
                <idx>pigpen cipher</idx>In his treatise on cryptology <xref ref="cr_crypt_vigenere" detail="p. 275b (534)"/> 
                Vigen&#x00E8;re describes a cipher that he found in Agripa's <em>De Occulta Philosophia</em>
                <xref ref="cr_crypt_agripa" detail="Vol. 3, p. CCLXXV (279)"/> in chapter 30 which discusses traditional ciphers 
                used by cabals.
            </p>
            <sidebyside widths="45% 45%" margins="0%">
                <figure xml:id="figure_vigenere_pig">
                    <caption> Vigenere's Variant on the Pigpen Cipher <!-- <xref ref="cr_crypt_vigenere" detail="p. 534 (275b)"/> --></caption>
                    <image width="100%" source="images/vigenere_p534.png">
                        <description> Vigenere's Pigpen Variant</description>
                    </image>
                </figure>
                <figure xml:id="figure_agripa_pig">
                    <caption> Agripa's Variant on the Pigpen Cipher<!--  <xref ref="cr_crypt_agripa" detail="Vol. 3, p. 279 (CCLXXV)"/> --></caption>
                    <image width="100%" source="images/agripa_p279.png">
                        <description> Agripa's Pigpen Variant</description>
                    </image>
                </figure>
            </sidebyside>
            <xi:include href="quote_code/agripa_pig.ptx" />
            <p>
                <alert>Comprehension Check:</alert>
                <ul>
                    <li>
                        If you hadn't seen the first step in how the name <em><q>Michael</q></em> was enciphered above, then how might you misinterpret the second enciphering?
                    </li>
                    <li>
                        Why in the final step do you think some of the symbols must be raised or lowered?
                    </li>
                    <li>
                        In the final step above Agripa eliminates all the marks, why would this cause confusion?  That is, if you follow his directions which letters will be confused with one another?
                    </li>
                    <li>
                        In the translated grid the letters are placed into the grid right to left, this is also the case in Agripa's work <xref ref="figure_agripa_pig"/>, try to find out why.
                    </li>
                </ul>
            </p>
            <exercise>
                <statement>
                    <p>
                        Use Agripa's cipher as translated above to encipher the quote: <q>Pigs are smarter than dogs, and both are smarter than Congress</q> - Elayne Boosler
                    </p>
                </statement>
                <answer>
                    <p>
                        Here are the first few words of the message:
                    </p>
                    <figure>
                        <caption>Cipher Text:</caption>
                        <image>
                            <latex-image>
                                \begin{tikzpicture}
                                    \draw (0,0)
                                        \ppg ++(-10pt,12pt) node {$\cdot\cdot$} ++(10pt,-12pt)
                                        \ppe ++(-10pt,12pt) node {$\cdot$} ++(10pt,-12pt)
                                        \ppb ++(-10pt,12pt) node {$\cdot$$\cdot$$\cdot$} ++(10pt,-12pt)
                                        \ppg ++(-10pt,12pt) node {$\cdot\cdot$} ++(10pt,-12pt)
                                        \ppc ++(-10pt,12pt) node {$\cdot$} ++(10pt,-12pt)
                                        \ppf ++(-10pt,12pt) node {$\cdot\cdot$} ++(10pt,-12pt)
                                        \ppc ++(-10pt,12pt) node {$\cdot$$\cdot$$\cdot$} ++(10pt,-12pt)
                                        \ppe ++(-10pt,12pt) node {$\cdot$} ++(10pt,-12pt)
                                        \ppg ++(-10pt,12pt) node {$\cdot\cdot$} ++(10pt,-12pt)
                                        \ppc ++(-10pt,12pt) node {$\cdot$} ++(10pt,-12pt)
                                        \ppc ++(-10pt,12pt) node {$\cdot$$\cdot$$\cdot$} ++(10pt,-12pt)
                                        \ppi ++(-10pt,12pt) node {$\cdot$} ++(10pt,-12pt)
                                        \ppg ++(-10pt,12pt) node {$\cdot$} ++(10pt,-12pt)
                                        \ppi ++(-10pt,12pt) node {$\cdot\cdot$}
                                    ;
                                \end{tikzpicture}
                            </latex-image>
                        </image>
                    </figure>
                </answer>
            </exercise>
            <exercise>
                <statement>
                    <p>
                        Decipher the words enciphered here using Agripa's cipher as presented above.
                    </p>
                    <figure>
                        <caption>
                            Cipher Text:
                        </caption>
                        <image>
                            <latex-image>
                                \begin{tikzpicture}
                                    \draw (0,0)
                                        \ppc ++(-10pt,12pt) node {$\cdot$$\cdot$$\cdot$} ++(10pt,-12pt)
                                        \ppe ++(-10pt,12pt) node {$\cdot\cdot$} ++(10pt,-12pt)
                                        \ppc ++(-10pt,12pt) node {$\cdot$} ++(10pt,-12pt)
                                        \ppe ++(-10pt,12pt) node {$\cdot$} ++(10pt,-12pt)
                                        \ppa ++(-10pt,12pt) node {$\cdot$} ++(10pt,-12pt)
                                        \ppc ++(-10pt,12pt) node {$\cdot\cdot$} ++(10pt,-12pt)
                                        \ppb ++(-10pt,12pt) node {$\cdot\cdot$} ++(10pt,-12pt)
                                        \ppg ++(-10pt,12pt) node {$\cdot\cdot$} ++(10pt,-12pt)
                                        \ppd ++(-10pt,12pt) node {$\cdot\cdot$} ++(10pt,-12pt)
                                        \ppi ++(-10pt,12pt) node {$\cdot\cdot$} ++(10pt,-12pt)
                                    ;
                                \end{tikzpicture}
                            </latex-image>
                        </image>
                    </figure>
                </statement>
                <answer>
                    <p>
                        Plaintext: <q>Pork 'n Beans</q>
                    </p>
                </answer>
            </exercise>
            <p>
                The pigpen cipher as we use it today has evolved and standardized to use the key in <xref ref="figure_modern_pig" text="type-global"/> which includes all twenty six letters of modern English.  It has the advantages that it is quick to learn and it is easy to recreate the cipher key. Also, for each shape you never add more than a single dot so that there is less opportunity for confusion.

            </p>
            <figure xml:id="figure_modern_pig">
                <caption> Modern key for the Pigpen Cipher</caption>
                <image width="50%" source="images/Pigpen.png">
                    <description> Modern Pigpen Cipher</description>
                </image>
            </figure>
            <exercise>
                <statement>
                    <p>
                        Use the key in <xref ref="figure_modern_pig" text="type-global"/> to decipher the message 
                        below.
                    </p>
<!--                    "I am fond of pigs. Dogs look up to us. Cats look down on us. Pigs treat us as equals." ― Winston S. Churchill -->
                    <figure>
                        <caption>Cipher Text</caption>
                        <image>
                            <latex-image>
                                \begin{tikzpicture}
                                    \draw (0,-0.5) \ppi ++(5pt,0pt) \ppa\ppm ++(5pt,0pt) \ppf\ppo\ppn\ppd ++(5pt,0pt) \ppo\ppf ++(5pt,0pt) \ppp\ppi\ppg\pps;
                                    
                                    \draw (0,-1) \ppd\ppo\ppg\pps ++(5pt,0pt) \ppl\ppo\ppo\ppk ++(5pt,0pt) \ppu\ppp ++(5pt,0pt) \ppt\ppo; 
                                    
                                    \draw (0,-1.5) \ppu\pps \ppc\ppa\ppt\pps ++(5pt,0pt) \ppl\ppo\ppo\ppk ++(5pt,0pt) \ppd\ppo\ppw\ppn;
                                    
                                    \draw (0,-2) \ppo\ppn ++(5pt,0pt) \ppu\pps ++(5pt,0pt) \ppp\ppi\ppg\pps ++(5pt,0pt) \ppt\ppr\ppe\ppa\ppt;
                                    
                                    \draw (0,-2.5) \ppu\pps ++(5pt,0pt) \ppa\pps ++(5pt,0pt) \ppe\ppq\ppu\ppa\ppl\pps;

                                    \draw (0,-3) \ppw\ppi\ppn\pps\ppt\ppo\ppn ++(5pt,0pt) \pps ++(5pt,0pt) \ppc\pph\ppu\ppr\ppc\pph\ppi\ppl\ppl;
                                \end{tikzpicture}
                            </latex-image>
                        </image>
                    </figure>
                </statement>
                <answer>
                    <p>
                        <q>I am fond of pigs. Dogs look up to us. Cats look down on us. Pigs treat us as equals.</q> ― Winston S. Churchill
                    </p>
                </answer>
            </exercise>
            <exercise>
                <statement>
                    <p>
                        Try to encipher the first few words of this next message using the modern variation on the pigpen cipher (<xref ref="figure_modern_pig" text="type-global"/>).
                    </p>
                    <p>
                        <q>Never wrestle with pigs. You both get dirty and the pig likes it.</q> ― George Bernard Shaw
                    </p>
                </statement>
                <answer>
                    <figure>
                        <caption>Cipher Text</caption>
                        <image>
                            <latex-image>
                                \begin{tikzpicture}
                                    \draw (0,-0.5) \ppn\ppe\ppv\ppe\ppr ++(5pt,0pt) \ppw\ppr\ppe\pps\ppt\ppl\ppe ++(5pt,0pt) node {$\cdots$};
                                \end{tikzpicture}
                            </latex-image>
                        </image>
                    </figure>
                </answer>
            </exercise>
            <p>
                <alert>Reflection:</alert>
                <ul>
                    <li>
                        Do you think that the pigpen cipher offers as much security as the Vigen&#x00E8;re cipher?  Why or why not?
                    </li>
                    <li>
                        In how many ways can you encipher each character using the pigpen cipher?  What type of cipher does that make this?
                    </li>
                    <li>
                        If you were confronted with a similar cipher which used symbols in place of letters how could you first rewrite your message so that you could then apply the cryptanalysis techniques we discussed previously?
                    </li>
                </ul>
            </p>
        </subsection>
    </section>




    <!--%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

        Vigenere and the Autokey Cipher 

    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%-->
    <section xml:id="section_vigenere">
        <title> An Automatic Hit </title>
        <objectives>
            <ul>
                <li>
                    Vigen&#x00E8;re's Biography
                </li>
                <li>
                    Vigen&#x00E8;re's Autokey Cipher
                </li>
            </ul>
        </objectives>
        <subsection xml:id="vigenere_bio">
            <title>Biography of Blaise de Vigen&#x00E8;re</title>
            <p>
                Insert biography when available
            </p>
        </subsection>
        <subsection xml:id="autokey_cipher">
            <title>The Autokey Cipher</title>
            <p>
                <idx>autokey</idx>
                Description of Alberti's autokey from Kahn ... </p>
            <p>
                Below is a description of Vigen&#x00E8;re's more secure variation on an autokey cipher.
                <fn>
                    This translation is mostly from Charles Mendelsohn in <xref ref="cr_crypt_mendelsohn_vigenere" detail="p. 128"/>, I have supplemented with material from the original description by Vigen&#x00E8;re is in <xref ref="cr_crypt_vigenere" detail="pp.49-49b"/>.
                </fn>
                Read carefully through the passage above, you will need to use <xref ref="vigenere_auto_table" text="type-global" /> in order to follow along.
            </p>
            <xi:include href="quote_code/vigenere_autokey.ptx" />
            <figure xml:id="vigenere_auto_table">
                <caption>Table used for Vigen&#x00E8;re's Autokey Cipher</caption>
                <image width="70%" source="images/vigenere_auto_table.png">
                    <description>This is the table that Vigen&#x00E8;re used for his Autokey Cipher</description>
                </image>
            </figure>
            <p>
                <alert>Comprehension Check:</alert> It will be easier to follow what is happening in this passage if we write out the message as follows:
            </p>
            <p>Text for the first cipher method:</p>
            <pre>
                    Plaintext:    a u n o m d e l e t e r n e l
                    Key Letter:   D A U N O M D E L E T E R N E
                    Ciphertext: D X I A H G U P T M L S H I X T
            </pre>
            <p>
                <ul>
                    <li>
                        Vigen&#x00E8;re uses a <em>D</em> as the key to encipher the first letter, in the first method described where does he get the subsequent letters for the key?
                    </li>
                    <li>
                        The letter <em>D</em> enciphers <em>a</em> as <em>X</em>, but the <em>a</em> is not in row <em>D</em> of <xref ref="vigenere_auto_table"/> so how do we know that the <em>a</em> should be <em>X</em> ?
                    </li>
                    <li>
                        At one point Vigen&#x00E8;re uses a key letter of <em>U</em> but there is no row <em>U</em> on his table, looking at how the <em>U</em> enciphers the <em>n</em>, what row is he using in place of <em>U</em>?
                    </li>
                    <li>
                        The <em>a</em> was enciphered as <em>X</em>, but the first letter of the ciphertext is <em>D</em>, also the ciphertext is one character longer than the plaintext, what is the explanation for both of these?  Where did the leading <em>D</em> come from?
                    </li>
                </ul>
            </p>
            <p>Text for the second cipher method:</p>
            <pre>
                    Plaintext:    a u n o m d e l e t e r n e l
                    Key Letter:   D X H E E C O U ...
                    Ciphertext: D X H E E C O U M ...
            </pre>
            <p>
                <ul>
                    <li>
                        In the second method described he again starts with a key of <em>D</em> but then where does he get the the next key letter <em>X</em>? What about the key letter <em>H</em>? Try to complete the cipher using the second method.
                    </li>
                    <li>
                        Vigen&#x00E8;re believes his second method is more secure, looking at the <em>key</em> for the second method why do you think he believes this?
                    </li>
                    <li>
                        If you compare the <em>key</em> for his second method to the cipher text he generates why is Vigen&#x00E8;re wrong about his second method being more secure?
                    </li>
                </ul>
            </p>
            <exercise>
                <statement>
                    <p>
                        Check your understanding by enciphering the message <em><q>automatic confusion</q></em> using Vigen&#x00E8;re's first and second autokey methods, use <em>Q</em> for the initial key letter.
                    </p>
                </statement>
                <answer>
                    <p>
                        Method 1:
                    </p>
                    <pre>
                        Plaintext:    a u t o m a t i c c o n f u s i o n
                        Key Letter:   Q A U T O M A T I C C O N F U S I O
                        Ciphertext: Q P I G A G R H M U N D H M A F M G H
                    </pre>
                    <p>
                        Method 2:
                    </p>
                    <pre>
                        Plaintext:    a u t o m a t i c c o n f u s i o n
                        Key Letter:   Q P E L G D X G R N T A B R F I Q L
                        Ciphertext: Q P E L G D X G R N T A B R F I Q L F
                    </pre>
                </answer>
            </exercise>
            <exercise>
                <statement>
                    <p>
                        The message <c>CHFABH CXNXM GFMRR MDDMR</c> was enciphered using Vigen&#x00E8;re's first autokey method, check your understanding of the method by deciphering it.
                    </p>
                </statement>
                <answer>
                    <pre>
                        Ciphertext: C H F A B H C X N X M G F M R R M D D M R
                        Key Letter:   C S T O R M T H E B A S T I L L E N U L
                        Plaintext:    s t o r m t h e b a s t i l l e n u l l
                    </pre>
                </answer>
            </exercise>
            <exercise>
                <statement>
                    <p>
                        The message <c>QMPTM GPOHG SOOHL QXUGC</c> was enciphered using Vigen&#x00E8;re's second autokey method, check your understanding of the method by deciphering it.
                    </p>
                </statement>
                <answer>
                    <pre>
                        Ciphertext: Q M P T M G P O H G S O O H L Q X U G C
                        Key Letter:   Q M P T M G P O H G S O O H L Q X U G
                        Plaintext:    h i d i n g i n p l a i n s i g h t x
                    </pre>
                </answer>
            </exercise>
            <p>
                <em><alert>Reflection:</alert></em> If you go back and look carefully at the preceding couple of exercises you will notice that deciphering a message enciphered using the first autokey method is equivalent to second method and vice versa.  In what way does this weaken the cipher?
            </p>
        </subsection>
    </section>




    <!--%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

        Falconer and the Columnar Transposition 

    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%-->
    <section xml:id="section_falconer_cipher">
        <title> Stirring Things Up </title>
        <objectives>
            <ul>
                <li>
                    Falconer's Discussion of Permutations
                </li>
                <li>
                    Falconer's Columnar Transposition
                </li>
            </ul>
        </objectives>
        <subsection xml:id="falconer_permutations">
            <title>Key Permutations</title>
            <assemblage>
                <p>
                    <alert>Sect. 2: Of Secret Writing by Altering the Places of the Letters, Where the Powers Remain the Same</alert>
                </p>
                <p>
                    <em>Part 1: Of the Combinations of Three or More Letters</em>
                </p>
                <p>
                    The first remarkable improvement I find of this kind of cryptography by altering the places of letters, is by the regular combinations of three, four, or more letters: I had it of a gentleman, who (I am fully satisfied) would put it to no bad use; but since it may fall of bad hands, I have his leave to provide against its harm.  And that we may proceed regularly therein it is necessary, first to inquire, <q>how many several ways any given number of letters may be combined?</q>  (i.e.) How many differnt positions they can regularly admit of.  And for that end I have hereunto subjoined the following table:
                </p>
                <sidebyside width="50%">
                    <image source="images/falconer_permutations.png" />
                </sidebyside>
                <p>
                    <em>Construction of the Table.</em>
                </p>
                <p>
                    <ol>
                        <li>
                            At the left-hand of your table stands a rank of figures expressing the number of letters to be combined, encreasing in an arithmetical proportion from unity, or 1 and by common excess of 1, or unity.
                        </li>
                        <li>
                            To the right hand of these stands the number of <em>Combinations,</em><fn>Today we call these permutations.</fn> or several ways they can be combined.
                        </li>
                        <li>
                            As for 1, being it has but one positions, I set 1 opposite to it in the rank of combinations.
                        </li>
                        <li>
                            I multiply 1, in the column of combinations, by two, in the column of letters, and set the product, viz. 2, opposite to it, which shows how often two letters or things can be combined, viz. two times.
                        </li>
                        <li>
                            I multiply the 2 in the row of combinations, by 3 in the column of letters; and over against it I set 6 for the product, which shows that three letters have sixe regular positions or combinations.
                        </li>
                        <li>
                            ...
                        </li>
                    </ol>
                </p>
                <p>
                    <em>Demonstration.</em>
                </p>
                <p>
                    <ol>
                        <li>
                            It is manifest, that one letter or thing has but one position, and two letters have twice the position of 1, viz. once before and once after it. e.g. <em>AB</em>, <em>BA</em>.
                        </li>
                        <li>
                            From the combination of two letters we find that of 3, for the new Letter added is three times applicable to the former positions, viz. in the beginning, middle, and end, e.g. the letter C being joyned with AB, the first combination may be CAB, and the second CBA.  Again put C in the middle, and it yields other differences, viz. ACB, BCA.  And when C is put in the lat place, you have a fifth and sixth difference, viz. ABC, BAC.
                        </li>
                        <li>
                            From the combination of three letters arises that of four letters; viz. ABCD: for D can be four several times applied to each of the former six differences; e.g. in the first, second, third, and fourth or last place.
                        </li>
                        <li>
                            From the twenty four combinations arising from four letters, you have that of 5; e.g. if the letter E is added, it is five times applicable to each of the former twenty four regular positions: and so for any other number in infinitum.
                        </li>
                    </ol>
                </p>
                <p>
                    I have said <em>regular</em> positions, because any number of letters or things may be <em>irregularly</em> varied in their positions very much above this order; for example, AB is capable of these irregular variations, AA, AB, BA, BB; and at this rate, three letters have no less than 27 positions in all, viz. six regular (as above) and twenty one irregular positions.  ...
                    - John Falconer <xref ref="cr_crypt_falconer" text="type-global" detail="pp. 37-40 (65-68)"/>
                </p>
            </assemblage>
            <p>
                <alert>Comprehension Check:</alert>
                <ul>
                    <li>
                        How many ways does Falconer state that we can rearrange the distinct letters ABCDE?
                    </li>
                    <li>
                        How does Falconer arrive at that number?  What does he mean when we says <em>"if the letter E is added, it is five times applicable to each of the former twenty four regular positions"</em>?
                    </li>
                    <li>
                        Based on what Falconer says above how many ways should we be able to arrange the distinct letters ABCDEF?  How would he explain that?
                    </li>
                    <li>
                        When Falconer speaks of irregular variations in the last paragraph which combinations of A and B is he considering that he hadn't before?
                    </li>
                    <li>
                        Why does he say that there would be 27 positions, how does he get 27 positions from 3 letters?
                    </li>
                    <li>
                        How many positions would there be if you had 4 letters, or 5?
                    </li>
                </ul>
                What Falconer is discussing here are the factorials we learned about earlier. (<xref ref="definition_factorial"/>) Factorials are related to two other ideas permutations and combinations, which we will explore later when we discuss more complicated ciphers.<idx>factorial</idx><idx>permutation</idx><idx>combination</idx> For now, let's see how Falconer uses these combinations of letters.
            </p>
        </subsection>
        <subsection xml:id="falconer_transposition">
            <title>Transposition</title>
            <assemblage>
                <p><em>A New Method How to Write Secretly by the Art of Combinations</em></p>
                <p>
                    <ol>
                        <li>
                            To write by the method proposed, a certain number of letters are combined to lock and unlock the epistle.  The differences of writing down the positions [of the letters] ... may be varied to a vast number; ...
                        </li>
                        <li>
                            The order of rows is agreed upon in parting.
                        </li>
                        <li>
                            The number of letters combined, which is the key, may be expressed in the epistle by some mathematical figure, as <m>\scriptsize\triangle</m> for three letters, <m>\Box</m> for 4, etc. or by some private mark.
                        </li>
                        <li>
                            They [the individuals communicating] frame a rectangular table of as many columns as there are letters combined.
                        </li>
                        <li>
                            The letters so combined are placed in their natural order along the top of the table.
                        </li>
                        <li>
                            Having determined of how many lines the table shall consist, the order of combinations agreed upon is set down in a row in the first column towards the left hand; as you may see in the following table.
                        </li>
                        <li>
                            The table being thus prepared for writing, they observe the order of the combinations, and write according to its direction.
                        </li>
                        <li>
                            When they have placed one letter of every column of all the lines, they begin a new, and so go on until the writing be finished.
                        </li>
                        <li>
                            And lastly, they take the letters out of the table according to their partitions, as so many barbarous words, upon paper apart and send it to the confidant. - John Falconer <xref ref="cr_crypt_falconer" text="type-global" detail="pp. 68-72 (40-43)"/>
                        </li>
                    </ol>
                </p>
            </assemblage>
            <p>
                <alert>Comprehension Check:</alert>
            </p>
            <p>
                Let's see if you can follow Falconer's directions.  Below I set up <xref ref="falconer_trans_table_1" text="type-global"/> according to his description in steps (5) and (6) and used it to encipher the pangram<idx>pangram</idx> <em><q>the quick brown fox jumps over the lazy sleeping dog.</q></em>
            </p>
            <p>
                <ul>
                    <li>
                        Looking at <xref ref="falconer_trans_table_2" text="type-global"/> why is the <em>the</em>
                        from the beginning of the sentence written backwards? (Be sure to look carefully at the
                        letters to the left of the row when answering.)
                    </li>
                    <li>
                        In the second row of the same table why is the <em>qui</em> from <em>quick</em>
                        written in the order it is written?
                        (Again, be sure to look carefully at the letters to the left of the row when answering.)
                    </li>
                    <li>
                        In the last row we put down the <em>n</em> from <em>brown</em> and the <em>fo</em> from <em>fox</em>, why are they in the
                        order they are in and looking at the next table (<xref ref="falconer_trans_table_3" text="type-global" />) where do we put
                        the <em>x</em> from <em>fox</em> and why?
                    </li>
                    <li>
                        How do we finish writing the rest of the message into the boxes in the table?
                    </li>
                    <li>
                        Looking at the final message why is there a little triangle at the start of the message and why
                        were the blocks of letters written in the order they were written?
                    </li>
                    <li>
                        In what ways is this different from other ciphers we have looked at?  (Hint: In this cipher what does
                        cipher text <em>E</em> represent, or cipher text <em>F</em>?)
                    </li>
                </ul>
            </p>
            <sidebyside widths="45% 45%">
                <table xml:id="falconer_trans_table_1">
                    <caption> Falconer's Transposition Table Initial Setup</caption>
                    <tabular top="minor" left="minor" right="minor" halign="center" bottom="minor">
                        <row>
                            <cell /><cell> </cell><cell>A</cell><cell>B</cell><cell>C</cell>
                        </row>
                        <row>
                            <cell>1</cell><cell>CBA</cell><cell><m>\phantom{WRW}</m></cell><cell><m>\phantom{WRW}</m></cell><cell><m>\phantom{WRW}</m></cell>
                        </row>
                        <row>
                            <cell>2</cell><cell>CAB</cell><cell><m>\phantom{WRW}</m></cell><cell><m>\phantom{WRW}</m></cell><cell><m>\phantom{WRW}</m></cell>
                        </row>
                        <row>
                            <cell>3</cell><cell>ACB</cell><cell><m>\phantom{WRW}</m></cell><cell><m>\phantom{WRW}</m></cell><cell><m>\phantom{WRW}</m></cell>
                        </row>
                        <row>
                            <cell>4</cell><cell>BCA</cell><cell><m>\phantom{WRW}</m></cell><cell><m>\phantom{WRW}</m></cell><cell><m>\phantom{WRW}</m></cell>
                        </row>
                        <row>
                            <cell>5</cell><cell>BAC</cell><cell><m>\phantom{WRW}</m></cell><cell><m>\phantom{WRW}</m></cell><cell><m>\phantom{WRW}</m></cell>
                        </row>
                    </tabular>
                </table>
                <table xml:id="falconer_trans_table_2">
                    <caption> Falconer's Transposition Table After the First Pass</caption>
                    <tabular top="minor" left="minor" right="minor" halign="center" bottom="minor">
                        <row>
                            <cell /><cell> </cell><cell>A</cell><cell>B</cell><cell>C</cell>
                        </row>
                        <row>
                            <cell>1</cell><cell>CBA</cell><cell>E</cell><cell>H</cell><cell>T</cell>
                        </row>
                        <row>
                            <cell>2</cell><cell>CAB</cell><cell>U</cell><cell>I</cell><cell>Q</cell>
                        </row>
                        <row>
                            <cell>3</cell><cell>ACB</cell><cell>C</cell><cell>B</cell><cell>K</cell>
                        </row>
                        <row>
                            <cell>4</cell><cell>BCA</cell><cell>W</cell><cell>R</cell><cell>O</cell>
                        </row>
                        <row>
                            <cell>5</cell><cell>BAC</cell><cell><m>\phantom{W}</m>F<m>\phantom{W}</m></cell>
                            <cell><m>\phantom{W}</m>N<m>\phantom{W}</m></cell>
                            <cell><m>\phantom{W}</m>O<m>\phantom{W}</m></cell>
                        </row>
                    </tabular>
                </table>
            </sidebyside>
            <sidebyside widths="45% 40%">
                <table xml:id="falconer_trans_table_3">
                    <caption> Falconer's Transposition Table Fully Filled</caption>
                    <tabular top="minor" left="minor" right="minor" halign="center" bottom="minor">
                        <row>
                            <cell /><cell> </cell><cell>A</cell><cell>B</cell><cell>C</cell>
                        </row>
                        <row>
                            <cell>1</cell><cell>CBA</cell><cell>EUS</cell><cell>HJY</cell><cell>TXZ</cell>
                        </row>
                        <row>
                            <cell>2</cell><cell>CAB</cell><cell>UPE</cell><cell>ISE</cell><cell>QML</cell>
                        </row>
                        <row>
                            <cell>3</cell><cell>ACB</cell><cell>COP</cell><cell>BEN</cell><cell>KVI</cell>
                        </row>
                        <row>
                            <cell>4</cell><cell>BCA</cell><cell>WHO</cell><cell>RRG</cell><cell>OTD</cell>
                        </row>
                        <row>
                            <cell>5</cell><cell>BAC</cell><cell><m>\phantom{I}</m>FL<m>\phantom{I}</m></cell>
                            <cell><m>\phantom{I}</m>NEG<m>\phantom{I}</m></cell>
                            <cell><m>\phantom{I}</m>OA<m>\phantom{I}</m></cell>
                        </row>
                    </tabular>
                </table>
                <stack>
                    <p><alert>Final Message:</alert></p>
                    <p><q><m>\scriptsize\triangle</m> EUS HJY TXZ UPE ISE QML COP BEN KVI WHO RRG OTD FL NEG OA</q></p>
                </stack>
            </sidebyside>
            <exercise>
                <statement>
                    <p>
                        Decipher the following message which used the same key as the one represented in
                        <xref ref="falconer_trans_table_1" text="type-global"/>:
                    </p>
                    <blockquote>
                        <p>
                            <m>\scriptsize\triangle</m> WU OO NR MD A IN L T L N U R D E A
                        </p>
                    </blockquote>
                </statement>
                <answer>
                    <p>Now I'm all turned around.</p>
                </answer>
                <solution>
                    <p>
                        First put the blocks of text into the table row by row in alphabetical order:
                    </p>
                    <table xml:id="falconer_trans_practice_1">
                        <caption> Falconer's Transposition Practice</caption>
                        <tabular top="minor" left="minor" right="minor" halign="center" bottom="minor">
                            <row>
                                <cell /><cell> </cell><cell>A</cell><cell>B</cell><cell>C</cell>
                            </row>
                            <row>
                                <cell>1</cell><cell>CBA</cell><cell>WU </cell><cell>OO </cell><cell>NR </cell>
                            </row>
                            <row>
                                <cell>2</cell><cell>CAB</cell><cell>MD </cell><cell>A </cell><cell>IN </cell>
                            </row>
                            <row>
                                <cell>3</cell><cell>ACB</cell><cell>L </cell><cell>T </cell><cell>L </cell>
                            </row>
                            <row>
                                <cell>4</cell><cell>BCA</cell><cell>N </cell><cell>U </cell><cell>R </cell>
                            </row>
                            <row>
                                <cell>5</cell><cell>BAC</cell><cell>D </cell><cell>E </cell><cell>A </cell>
                            </row>
                        </tabular>
                        <p>
                            Now read the message out character by character according to the combinations at the left:
                        </p>
                        <p>nowimallturnedaround</p>
                        <p>
                            Finally, we get the original message.
                        </p>
                        <p>Now I'm all turned around.</p>
                </table>
                </solution>
            </exercise>
            <exercise>
                <statement>
                    <p>
                        Encipher the following message using the same key as the one represented in 
                        <xref ref="falconer_trans_table_1" text="type-global"/>:
                    </p>
                    <blockquote>
                        <p>
                            <q>As long as the world is turning and spinning, we're gonna be dizzy and we're gonna make 
                            mistakes.</q> - Mel Brooks
                        </p>
                    </blockquote>
                </statement>
                <answer>
                    <p>
                        <m>\scriptsize\triangle</m>LSNDNE SINENM ADIBOS NUNZMB GRGZAR OTIIAL ANWYKO TNRNMK SIEAEO WNOET HGEDIS EAGWS RSNEK ODNRA LPAGE
                    </p>
                </answer>
                <solution>
<!--                     Chracters in text:  85
                    Cipher Table:
                        CBA :   LSNDNE  SINENM  ADIBOS
                        CAB :   NUNZMB  GRGZAR  OTIIAL
                        ACB :   ANWYKO  TNRNMK  SIEAEO
                        BCA :   WNOET   HGEDIS  EAGWS
                        BAC :   RSNEK   ODNRA   LPAGE
                    Completed Message:
                    LSNDNE SINENM ADIBOS NUNZMB GRGZAR OTIIAL ANWYKO
                    TNRNMK SIEAEO WNOET HGEDIS EAGWS RSNEK ODNRA LPAGE -->
                    <p>
                        First we break up the message into blocks of three to make it easier to work with.
                    </p>
                    <pre>
                        ASL ONG AST HEW ORL
                        DIS TUR NIN GAN DSP
                        INN ING WER EGO NNA
                        BED IZZ YAN DWE REG
                        ONN AMA KEM IST AKE
                        SME LBR OOK S
                    </pre>
                    <p>
                        Then copy each character into the table using the combination keys at the side to tell us which column to put each character in.
                    </p>
                    <table xml:id="falconer_practice_table_2">
                        <caption> Falconer's Transposition Practice</caption>
                        <tabular top="minor" left="minor" right="minor" halign="center" bottom="minor">
                            <row>
                                <cell /><cell> </cell><cell>A</cell><cell>B</cell><cell>C</cell>
                            </row>
                            <row>
                                <cell>1</cell><cell>CBA</cell><cell>LSNDNE</cell>  <cell>SINENM</cell>  <cell>ADIBOS</cell>
                            </row>
                            <row>
                                <cell>2</cell><cell>CAB</cell><cell>NUNZMB</cell>  <cell>GRGZAR</cell>  <cell>OTIIAL</cell>
                            </row>
                            <row>
                                <cell>3</cell><cell>ACB</cell><cell>ANWYKO</cell>  <cell>TNRNMK</cell>  <cell>SIEAEO</cell>
                            </row>
                            <row>
                                <cell>4</cell><cell>BCA</cell><cell>WNOET</cell>   <cell>HGEDIS</cell>  <cell>EAGWS</cell>
                            </row>
                            <row>
                                <cell>5</cell><cell>BAC</cell><cell>RSNEK</cell>   <cell>ODNRA</cell>   <cell>LPAGE</cell>
                            </row>
                        </tabular>
                    </table>
                    <p>
                        Finally, we read the message out of the table from left to right and from top to bottom.
                    </p>
                    <p>
                        <m>\scriptsize\triangle</m>LSNDNE SINENM ADIBOS NUNZMB GRGZAR OTIIAL ANWYKO TNRNMK SIEAEO WNOET HGEDIS EAGWS RSNEK ODNRA LPAGE
                    </p>
                </solution>
            </exercise>
            <exercise>
                <statement>
                    <p>
                        Encipher the following message using the three letters as before, but with the row keys 
                        <c>ACB - CAB - BAC - ABC</c>, <xref ref="appendix_trans_table" text="type-global"/> is a blank table you 
                        can copy if you need to:
                    </p>
                    <blockquote>
                        <p>
                            <q>A person who never made a mistake never tried anything new.</q> - Albert Einstein
                        </p>
                    </blockquote>
                </statement>
                <answer>
                    <p>
                        <m>\scriptsize\triangle</m>AVADAI ERENB PEKALN SAETR ODVHT RMNYE WARNI NEEIE HMTGN OIRNS NSIET ETEWE
                    </p>
                </answer>
                <solution>
<!--                     Chracters in text:  62
                    Cipher Table:
                        ACB :   AVADAI  ERENB   PEKALN
                        CAB :   SAETR   ODVHT   RMNYE
                        BAC :   WARNI   NEEIE   HMTGN
                        ABC :   OIRNS   NSIET   ETEWE
                    Completed Message:
                    AVADAI ERENB PEKALN SAETR ODVHT RMNYE WARNI NEEIE
                    HMTGN OIRNS NSIET ETEWE -->
                    <p>
                        First we break up the message into blocks of three to make it easier to work with.
                    </p>
                    <pre>
                        APE RSO NWH ONE
                        VER MAD EAM IST
                        AKE NEV ERT RIE
                        DAN YTH ING NEW
                        ALB ERT EIN STE
                        IN
                    </pre>
                    <p>
                        Then copy each character into the table using the combination keys at the side to tell us which column to put each character in.
                    </p>
                    <table xml:id="falconer_practice_table_3">
                        <caption> Falconer's Transposition Practice</caption>
                        <tabular top="minor" left="minor" right="minor" halign="center" bottom="minor">
                            <row>
                                <cell /><cell> </cell><cell>A</cell><cell>B</cell><cell>C</cell>
                            </row>
                            <row>
                                <cell>1</cell><cell>ACB</cell><cell>AVADAI</cell><cell>ERENB </cell> <cell>PEKALN </cell>
                            </row>
                            <row>
                                <cell>2</cell><cell>CAB</cell><cell>SAETR</cell><cell>ODVHT</cell><cell>RMNYE </cell>
                            </row>
                            <row>
                                <cell>3</cell><cell>BAC</cell><cell>WARNI</cell>  <cell>NEEIE</cell>  <cell>HMTGN</cell>
                            </row>
                            <row>
                                <cell>4</cell><cell>ABC</cell><cell>OIRNS</cell>   <cell>NSIET</cell>  <cell>ETEWE</cell>
                            </row>
                        </tabular>
                    </table>
                    <p>
                        Finally, we read the message out of the table from left to right and from top to bottom.
                    </p>
                    <p>
                        <m>\scriptsize\triangle</m>AVADAI ERENB PEKALN SAETR ODVHT RMNYE WARNI NEEIE HMTGN OIRNS NSIET ETEWE
                    </p>
                </solution>
            </exercise>
        </subsection>
    </section>


    <!--%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

        Thomas Jefferson's Wheel Cipher 

    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%-->
    <section xml:id="section_jefferson_cipher">
        <title>(*)Presidential Secrets</title>
        <objectives>
            <ul>
                <li>
                    Jefferson's Biography
                </li>
                <li>
                    Jefferson's Wheel Cipher
                </li>
            </ul>
        </objectives>
        <subsection xml:id="jefferson_bio">
            <title>Thomas Jefferson's Biography</title>
            <p>
                A brief biography of
                <url href="https://www.monticello.org/site/jefferson/thomas-jefferson-brief-biography">
                Thomas Jefferson</url>.
            </p>
        </subsection>
        <subsection xml:id="jefferson_wheel">
            <title>Thomas Jefferson's Wheel Cipher</title>
            <p>
                A brief description of Thomas Jefferson's 
                <url href="https://www.monticello.org/site/research-and-collections/wheel-cipher">
                wheel cipher</url>.
            </p>
            <exercise>
                <statement>
                    <p>
                        Insert Jefferson Exercise Here!!!
                    </p>
                </statement>
            </exercise>
        </subsection>

    </section>


    <!--%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

        Exercises

    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%-->

    <exercises xml:id="poly_exercises">
        <title> How Mixed Up Do You Feel?</title>
        <exercise>
            <statement>
                <p>
                    Encipher this message using a <em>Pigpen Cipher</em>.
                    <xref ref="appendix_figure_pigpen" text="type-global" />
                </p>
                <blockquote>
                    <p>
                        <q>You can put wings on a pig, but you don't make it an eagle.</q> - William J. Clinton
                    </p>
                </blockquote>
            </statement>
        </exercise>
        <exercise>
            <statement>
                <p>
                    Decipher this message written using a <em>Pigpen Cipher</em>.
                    <xref ref="appendix_figure_pigpen" text="type-global" />
                </p>
                <figure>
                    <caption>Cipher Text</caption>
                    <image>
                        <latex-image>
                            \begin{tikzpicture}<!-- THAT'S ALL FOLKS -->
                                \draw (0,-0.5) \ppt\pph\ppa\ppt\pps ++(5pt,0pt) \ppa\ppl\ppl ++(5pt,0pt) \ppf\ppo\ppl\ppk\pps;
                            \end{tikzpicture}
                        </latex-image>
                    </image>
                </figure>
            </statement>
        </exercise>
        <exercise>
            <statement>
                <p>
                    Encipher the following message with Alberti's polyalphabetic cipher, 
                    <xref ref="appendix_figure_alberti" text="type-global"/>, use and index letter of <em>s</em> and key 
                    letters <em>C</em>, <em>G</em>, and <em>X</em> (switch key letter after every other word).
                </p>
                <blockquote>
                    <p>
                        <q>
                            Men can do all things if they will.
                        </q> - Leon Battista Alberti
                    </p>
                </blockquote>
            </statement>
        </exercise>
        <exercise>
            <statement>
                <p>
                    Encipher the following message using the modern version of the Vigenere Square 
                    <xref ref="appendix_figure_vigenere_new" text="type-global"/> and a keyword of <em>FRANCE</em>.
                </p>
                <blockquote>
                    <p>
                        <q>
                            Hope is a good breakfast, but it is a bad supper.
                        </q> -  Francis Bacon
                    </p>
                </blockquote>
            </statement>
        </exercise>
        <exercise>
            <statement>
                <p>
                    Use the modern Vigenere Square 
                    <xref ref="appendix_figure_vigenere_new" text="type-global"/>
                    to decipher the following message which was enciphered using a key word of <em>STATE</em>.
                </p>
                    <pre>
                        LAEKI SKEGS KXCKI LLTHW MVCXW KBTBW LAEKI KNLMS 
                        XIRXT SKAMM GGHTV VPOKO SGDEI SKNBR YYRHQ XTIEY 
                        JXCHP AGPHA WEL
                    </pre>
            </statement>
        </exercise>
        <exercise>
            <statement>
                <p>
                    Encipher this quote with an <em>Autokey Cipher</em> with a key letter of <em>F</em>, 
                    use Vigenere's original table for this one.
                    <xref ref="appendix_figure_vigenere_auto_table" text="type-global"/>
                </p>
                <blockquote>
                    <p>
                        <q>
                            Obstacles are those frightful things you see when you take your eyes off your goal.
                        </q> - Henry Ford
                    </p>
                </blockquote>
            </statement>
        </exercise>
        <exercise>
            <statement>
                <p>
                    Encipher this quote with an <em>Autokey Cipher</em> with a key letter of <em>J</em>, 
                    use the modern Vigenere Square for this one.
                    <xref ref="appendix_figure_vigenere_new" text="type-global"/>
                </p>
                <blockquote>
                    <p>
                        <q>
                            Success is not final, failure is not fatal: it is the courage to continue that counts. 
                        </q> - Winston Churchill
                    </p>
                </blockquote>
            </statement>
        </exercise>
        <exercise>
            <statement>
                <p>
                    Use the modern Vigenere Square 
                    <xref ref="appendix_figure_vigenere_new" text="type-global"/>
                    to decipher the following message which was enciphered using an Autokey Cipher and key letter of <em>X</em>.
                </p>
                    <pre>
                        ARBHN LAALA LVVEN LRAPV TZALC ACNGW RAMTM ZXFSR VVT
                    </pre>
            </statement>
        </exercise>
<!--            <exercise>
                <statement>
                    <p>
                        Jefferson practice enciphering
                    </p>
                </statement>
            </exercise>
            <exercise>
                <statement>
                    <p>
                        Jefferson practice enciphering
                    </p>
                </statement>
            </exercise>
            <exercise>
                <statement>
                    <p>
                        Jefferson practice deciphering
                    </p>
                </statement>
            </exercise> -->
            <exercise>
                <statement>
                    <p>
                        Encipher the following message using Falconers Columnar Transposition with 
                        a key of <em>{ACB,BCA,CAB,ABC}</em>.
                        <xref ref="appendix_trans_table" text="type-global"/>
                    </p>
                    <blockquote>
                        <p>
                            <q>
                                Were I not a king, I would be a university man.
                            </q> -  King James I
                        </p>
                    </blockquote>
                </statement>
            </exercise>
            <exercise>
                <statement>
                    <p>
                        Encipher the following message using Falconers Columnar Transposition with 
                        a key of <em>{CBA,ABC,BCA,CAB,ACB,BAC}</em>.
                        <xref ref="appendix_trans_table" text="type-global"/>
                    </p>
                    <blockquote>
                        <p>
                            <q>
                                I have loved justice and hated iniquity: therefore I die in exile. 
                            </q> -  Pope Gregory VII
                        </p>
                    </blockquote>
                </statement>
            </exercise>
            <exercise>
                <statement>
                    <p>
                        Decipher the following message using Falconers Columnar Transposition with 
                        a key of <em>{ABC,BCA,BCA,ACB}</em>.
                        <xref ref="appendix_trans_table" text="type-global"/>
                    </p>
                        <pre>
                            ISUIIP TTRNLE IADOLA OTTSM SREUIR NSSRAE NOYVA TOI  
                            ES IHNLH TLBEK EOTWS HDUSE
                        </pre>
                </statement>
            </exercise>
            <conclusion>
                <p><alert>Substitution Cipher Cell:</alert></p>

                <sage>
                    <input><xi:include href="sage_code/subst_cipher.sage" parse="text"/></input>
                    <output></output>
                </sage>

                <p><em><alert>Vigenere Cipher Cell:</alert></em></p>

                <sage>
                    <input><xi:include href="sage_code/vigenere_cipher.sage" parse="text"/></input>
                    <output></output>
                </sage>

                <p><alert>Falconer's Tabular Cipher:</alert></p>

                <sage>
                    <input><xi:include href="sage_code/falconer_cipher.sage" parse="text"/></input>
                    <output></output>
                </sage>

            </conclusion>
    </exercises>


</chapter>
